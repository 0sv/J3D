<html> 
 
<head> 
<title>001 | Hierarchy | J3D</title> 

<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"> 

<script type="text/javascript" src="../build/glMatrix.js"></script>
<script type="text/javascript" src="../build/j3d.js"></script>

<script type="text/javascript" src="models/text.js"></script>

<link rel="stylesheet" href="common.css"/>

<script>
	var speed = 0.05;
	var mx, my = 0;
	
	function init() {
		engine = new J3D.Engine();
		
		camera = J3D.Camera.create(45, 1, 1000);
		camera.transform.position.z = -3;
		camera.transform.rotation.y = Math.PI;
		engine.camera = camera;

		sun = new J3D.Transform();
		sun.isStatic = true;
		sun.light = new J3D.Light(J3D.DIRECT);
		sun.light.color = new Color(.7,.7,.7, 1);
		sun.light.direction = new v3(-1, 0, 0).norm();
		
		sun2 = new J3D.Transform();
		sun2.isStatic = true;
		sun2.light = new J3D.Light(J3D.DIRECT);
		sun2.light.color = new Color(.7,.7,.7, 1);
		sun2.light.direction = new v3(1, 0, 0).norm();
		
		pt1 = new J3D.Transform();
		pt1.light = new J3D.Light(J3D.POINT);
		pt1.light.color = new Color(1, .9, .7, 1);
		pt1.position.z = -3;
		
		scene = engine.scene;
		scene.ambient = new Color(.25, .25, .25, 1);
		
		scene.add(camera.transform);
		scene.add(sun);
		scene.add(sun2);
		scene.add(pt1);
		
		makeRings();
		
		document.onmousemove = onMouseMove;
		draw();
	}
	
	function onMouseMove(e) {
		mx = ( e.clientX / window.innerWidth  ) * 2 - 1;
		my = ( e.clientY / window.innerHeight ) * 2 - 1;
		
		speed += mx/1000;
	}
	
	function draw() {
		requestAnimationFrame(draw);
		
		if(!mx) mx = 0;
		if(!my) my = 0;
		
		var sx = mx * Time.deltaTime / 1000;
		var sy = my * Time.deltaTime / 1000;
		
		text.rotation.y += sx;
		
		r1.rotation.y += sx;
		r2.rotation.y -= sx * 0.1;
		r3.rotation.y -= sx * 0.12;
		r4.rotation.y -= sx * 0.14;
		r5.rotation.y -= sx * 0.16;
		r6.rotation.y -= sx * 0.18;
		r7.rotation.y -= sx * 0.2;
		
		r1.rotation.x += sy;
		r2.rotation.x -= sy * 0.1;
		r3.rotation.x -= sy * 0.12;
		r4.rotation.x -= sy * 0.14;
		r5.rotation.x -= sy * 0.16;
		r6.rotation.x -= sy * 0.18;
		r7.rotation.x -= sy * 0.2;
		
		engine.render();
	}
	
	function makeRings() {
		text = new J3D.Transform();
		text.mesh = new J3D.Mesh(Text);
		text.renderer = new J3D.Phong();
		text.renderer.color = new Color(.6,.6,.6, 1);
		text.renderer.specularIntensity = 10;
		
		var si = 20;
		
		r1 = new J3D.Transform();
		r1.mesh = new J3D.Mesh(Ring1);
		r1.renderer = new J3D.Phong();
		r1.renderer.color = new Color(1, 0, 0, 1);
		r1.renderer.specularIntensity = si;
		
		r2 = new J3D.Transform();
		r2.mesh = new J3D.Mesh(Ring2);
		r2.renderer = new J3D.Phong();
		r2.renderer.color = new Color(1, .5, 0, 1);
		r2.renderer.specularIntensity = si;
		
		r3 = new J3D.Transform();
		r3.mesh = new J3D.Mesh(Ring3);
		r3.renderer = new J3D.Phong();
		r3.renderer.color = new Color(1, 1, 0, 1);
		r3.renderer.specularIntensity = si;
		
		r4 = new J3D.Transform();
		r4.mesh = new J3D.Mesh(Ring4);
		r4.renderer = new J3D.Phong();
		r4.renderer.color = new Color(.5, 1, 0, 1);
		r4.renderer.specularIntensity = si;
		
		r5 = new J3D.Transform();
		r5.mesh = new J3D.Mesh(Ring5);
		r5.renderer = new J3D.Phong();
		r5.renderer.color = new Color(0, 1, 0, 1);
		r5.renderer.specularIntensity = si;
		
		r6 = new J3D.Transform();
		r6.mesh = new J3D.Mesh(Ring6);
		r6.renderer = new J3D.Phong();
		r6.renderer.color = new Color(0, 1, 1, 1);
		r6.renderer.specularIntensity = si;
		
		r7 = new J3D.Transform();
		r7.mesh = new J3D.Mesh(Ring7);
		r7.renderer = new J3D.Phong();
		r7.renderer.color = new Color(0, .5, 1, 1);
		r7.renderer.specularIntensity = 8;
		
		// Build hierarchy, in 1 line!
		
		scene.add(text).add(r1).add(r2).add(r3).add(r4).add(r5).add(r6).add(r7);
	}
	
</script>

</head> 

<body onload="init();">
</body> 

</html> 